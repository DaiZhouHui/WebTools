<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨èƒ½æœç´¢èµ·å§‹é¡µ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.css">
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; 
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            transition: background 0.5s ease;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        /* é¡¶éƒ¨æ§åˆ¶æ  */
        .top-bar {
            background: #f8fafc;
            padding: 12px 20px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .category-tabs {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            flex: 1;
        }
        
        .category-tab {
            padding: 8px 16px;
            background: #e2e8f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .category-tab:hover {
            background: #cbd5e1;
        }
        
        .category-tab.active {
            background: white;
            color: #4f46e5;
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.2);
        }
        
        .settings-icon {
            background: rgba(79, 70, 229, 0.1);
            border: 2px solid rgba(79, 70, 229, 0.2);
            color: #4f46e5;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            margin-left: 10px;
        }
        
        .settings-icon:hover {
            background: #4f46e5;
            color: white;
            transform: rotate(30deg);
        }
        
        /* æœç´¢ç½‘æ ¼æ ·å¼ */
        .main-content {
            padding: 25px;
        }
        
        .search-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .search-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #f1f5f9;
            display: flex;
            flex-direction: column;
            gap: 15px;
            cursor: move;
            position: relative;
        }
        
        .search-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
            border-color: #c7d2fe;
        }
        
        .search-card.sortable-ghost {
            opacity: 0.4;
            background: #f1f5f9;
        }
        
        .search-card.sortable-chosen {
            box-shadow: 0 10px 25px rgba(79, 70, 229, 0.2);
        }
        
        .card-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            z-index: 2;
        }
        
        .card-control-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #e2e8f0;
            color: #64748b;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .card-control-btn:hover {
            background: white;
            border-color: #cbd5e1;
            color: #4f46e5;
            transform: scale(1.1);
        }
        
        .card-control-btn.sort-handle:hover {
            cursor: move;
        }
        
        .card-control-btn.hide-btn:hover {
            color: #ef4444;
        }
        
        .search-header {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .icon-container {
            width: 50px;
            height: 50px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .icon-container:hover {
            transform: scale(1.1);
        }
        
        .search-info {
            flex: 1;
        }
        
        .search-info h3 {
            color: #1e293b;
            font-size: 1.2rem;
            margin-bottom: 4px;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .search-info h3:hover {
            color: #4f46e5;
        }
        
        .search-info p {
            color: #64748b;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .input-group {
            display: flex;
            gap: 8px;
        }
        
        .input-group input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: #f8fafc;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #4f46e5;
            background: white;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .input-group button {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .input-group button:hover {
            background: linear-gradient(135deg, #4338ca, #6d28d9);
            transform: scale(1.03);
        }
        
        /* è‡ªå®šä¹‰æç¤ºæ¡†æ ·å¼ */
        .custom-alert {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .custom-alert.active {
            opacity: 1;
            visibility: visible;
        }
        
        .alert-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .custom-alert.active .alert-content {
            transform: translateY(0);
        }
        
        .alert-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .alert-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .alert-icon.success {
            background: linear-gradient(135deg, #10b981, #34d399);
        }
        
        .alert-icon.warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }
        
        .alert-icon.error {
            background: linear-gradient(135deg, #ef4444, #f87171);
        }
        
        .alert-header h3 {
            color: #1e293b;
            font-size: 1.5rem;
        }
        
        .alert-message {
            color: #64748b;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .alert-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        
        .alert-btn {
            padding: 10px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .alert-btn.cancel {
            background: #e2e8f0;
            color: #64748b;
        }
        
        .alert-btn.cancel:hover {
            background: #cbd5e1;
        }
        
        .alert-btn.confirm {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
        }
        
        .alert-btn.confirm:hover {
            background: linear-gradient(135deg, #4338ca, #6d28d9);
            transform: scale(1.05);
        }
        
        /* è®¾ç½®é¢æ¿æ ·å¼ */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -500px;
            width: 500px;
            height: 100vh;
            background: white;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.15);
            padding: 30px;
            overflow-y: auto;
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
        }
        
        .settings-panel.active {
            right: 0;
        }
        
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .settings-header h2 {
            color: #1e293b;
            font-size: 1.8rem;
        }
        
        .close-settings {
            background: none;
            border: none;
            font-size: 2rem;
            color: #64748b;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .close-settings:hover {
            color: #4f46e5;
            background: #f1f5f9;
        }
        
        .settings-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .settings-section {
            background: #f8fafc;
            border-radius: 14px;
            padding: 20px;
        }
        
        .settings-section h3 {
            color: #1e293b;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .settings-section h3 i {
            color: #4f46e5;
        }
        
        /* åŠŸèƒ½å¼€å…³æ ·å¼ */
        .feature-switches {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .feature-switch {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: white;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }
        
        .switch-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .switch-info h4 {
            color: #1e293b;
            font-size: 1.1rem;
        }
        
        .switch-info p {
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #cbd5e1;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #4f46e5;
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        /* å¯¼å…¥å¯¼å‡ºæŒ‰é’®æ ·å¼ */
        .import-export-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .import-export-btn {
            flex: 1;
            background: white;
            border: 2px solid #e2e8f0;
            color: #475569;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .import-export-btn:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        
        .import-export-btn.export {
            background: linear-gradient(135deg, #10b981, #34d399);
            border-color: #10b981;
            color: white;
        }
        
        .import-export-btn.export:hover {
            background: linear-gradient(135deg, #0da271, #2bb184);
        }
        
        /* æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™è¡¨å• */
        .add-site-form {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px dashed #cbd5e1;
            margin-bottom: 20px;
        }
        
        .add-site-form h4 {
            color: #1e293b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #475569;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .custom-category-input {
            display: none;
            margin-top: 10px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .form-help {
            color: #64748b;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        .category-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .category-filter {
            padding: 8px 16px;
            background: #e2e8f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }
        
        .category-filter:hover {
            background: #cbd5e1;
        }
        
        .category-filter.active {
            background: #4f46e5;
            color: white;
        }
        
        .sites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            max-height: 350px;
            overflow-y: auto;
            padding: 10px;
            background: white;
            border-radius: 12px;
        }
        
        .site-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .site-checkbox:hover {
            border-color: #4f46e5;
            transform: translateX(3px);
        }
        
        .site-checkbox input {
            width: 16px;
            height: 16px;
            accent-color: #4f46e5;
        }
        
        .site-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .small-icon {
            width: 28px;
            height: 28px;
            border-radius: 7px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
            flex-shrink: 0;
        }
        
        .settings-actions {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background: #e2e8f0;
            border: 2px solid #e2e8f0;
            color: #475569;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .action-btn:hover {
            background: #cbd5e1;
        }
        
        .action-btn.primary {
            background: #4f46e5;
            border-color: #4f46e5;
            color: white;
        }
        
        .action-btn.primary:hover {
            background: #4338ca;
            border-color: #4338ca;
        }
        
        /* é®ç½©å±‚ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 999;
        }
        
        .overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* ç©ºçŠ¶æ€æç¤º */
        .empty-state {
            text-align: center;
            padding: 50px 20px;
            color: #64748b;
            grid-column: 1 / -1;
        }
        
        .empty-state i {
            font-size: 3.5rem;
            margin-bottom: 15px;
            color: #cbd5e1;
        }
        
        .empty-state h3 {
            font-size: 1.6rem;
            margin-bottom: 10px;
            color: #475569;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .search-grid {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .top-bar {
                padding: 10px 15px;
                flex-direction: column;
                gap: 15px;
            }
            
            .category-tabs {
                width: 100%;
                overflow-x: auto;
                justify-content: flex-start;
                padding-bottom: 5px;
            }
            
            .settings-icon {
                position: absolute;
                top: 15px;
                right: 15px;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .search-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .search-card {
                padding: 15px;
            }
            
            .settings-panel {
                width: 100%;
                right: -100%;
                padding: 20px;
            }
            
            .sites-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .settings-actions {
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .settings-icon {
                width: 35px;
                height: 35px;
                font-size: 1.1rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .input-group button {
                width: 100%;
            }
            
            .category-tab {
                padding: 6px 12px;
                font-size: 0.85rem;
            }
            
            .card-control-btn {
                width: 24px;
                height: 24px;
                font-size: 0.8rem;
            }
            
            .alert-content {
                padding: 20px;
            }
            
            .alert-actions {
                flex-direction: column;
            }
            
            .alert-btn {
                width: 100%;
            }
        }
        
        /* æ’åºæç¤º */
        .sorting-hint {
            text-align: center;
            color: #64748b;
            font-size: 0.9rem;
            padding: 10px;
            margin-top: 10px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px dashed #cbd5e1;
        }
        
        .sorting-hint i {
            color: #4f46e5;
            margin-right: 5px;
        }
        
        .sorting-hint.disabled {
            display: none;
        }
        
        /* éšè—çš„æ–‡ä»¶è¾“å…¥æ¡† */
        .file-input-hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- è‡ªå®šä¹‰æç¤ºæ¡† -->
    <div class="custom-alert" id="customAlert">
        <div class="alert-content">
            <div class="alert-header">
                <div class="alert-icon" id="alertIcon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <h3 id="alertTitle">æç¤º</h3>
            </div>
            <div class="alert-message" id="alertMessage"></div>
            <div class="alert-actions">
                <button class="alert-btn cancel" id="alertCancel">å–æ¶ˆ</button>
                <button class="alert-btn confirm" id="alertConfirm">ç¡®å®š</button>
            </div>
        </div>
    </div>
    
    <!-- è®¾ç½®é¢æ¿ -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h2><i class="fas fa-sliders-h"></i> è‡ªå®šä¹‰è®¾ç½®</h2>
            <button class="close-settings" id="closeSettings">Ã—</button>
        </div>
        
        <div class="settings-content">
            <!-- 1. åŠŸèƒ½å¼€å…³ -->
            <div class="settings-section">
                <h3><i class="fas fa-toggle-on"></i> åŠŸèƒ½å¼€å…³</h3>
                <div class="feature-switches">
                    <div class="feature-switch">
                        <div class="switch-info">
                            <h4>å¯ç”¨æ’åºåŠŸèƒ½</h4>
                            <p>å¯ç”¨åå¯ä»¥æ‹–æ‹½å¡ç‰‡é‡æ–°æ’åº</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="enableSort">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="feature-switch">
                        <div class="switch-info">
                            <h4>å¯ç”¨éšè—åŠŸèƒ½</h4>
                            <p>å¯ç”¨åå¯ä»¥éšè—ä¸éœ€è¦çš„ç½‘ç«™</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="enableHide">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <!-- å¯¼å…¥å¯¼å‡ºæŒ‰é’® -->
                <div class="import-export-buttons">
                    <button class="import-export-btn" id="importSettings">
                        <i class="fas fa-upload"></i> å¯¼å…¥é…ç½®
                    </button>
                    <button class="import-export-btn export" id="exportSettings">
                        <i class="fas fa-download"></i> å¯¼å‡ºé…ç½®
                    </button>
                </div>
            </div>
            
            <!-- 2. åˆ†ç±»ç­›é€‰ -->
            <div class="settings-section">
                <h3><i class="fas fa-filter"></i> åˆ†ç±»ç­›é€‰</h3>
                <div class="category-filters" id="categoryFilters">
                    <!-- åˆ†ç±»æ ‡ç­¾å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- 3. é€‰æ‹©è¦æ˜¾ç¤ºçš„ç½‘ç«™ -->
            <div class="settings-section">
                <h3><i class="fas fa-check-circle"></i> é€‰æ‹©è¦æ˜¾ç¤ºçš„ç½‘ç«™</h3>
                <p class="form-help">æç¤ºï¼šåœ¨ä¸»ç•Œé¢å¯ä»¥æ‹–æ‹½å¡ç‰‡è¿›è¡Œæ’åºï¼ˆéœ€è¦å…ˆå¯ç”¨æ’åºåŠŸèƒ½ï¼‰</p>
                
                <div class="sites-grid" id="sitesGrid">
                    <!-- ç½‘ç«™å¤é€‰æ¡†å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="settings-actions">
                <button class="action-btn" id="selectAll">
                    <i class="fas fa-check-double"></i> å…¨é€‰
                </button>
                <button class="action-btn" id="deselectAll">
                    <i class="fas fa-times-circle"></i> å…¨ä¸é€‰
                </button>
                <button class="action-btn" id="resetOrder">
                    <i class="fas fa-sort-amount-down"></i> é‡ç½®æ’åº
                </button>
                <button class="action-btn primary" id="saveSettings">
                    <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
                </button>
            </div>
            
            <!-- 4. è‡ªå®šä¹‰ç½‘ç«™ç®¡ç† -->
            <div class="settings-section" id="customSitesSection" style="display: none;">
                <h3><i class="fas fa-user-cog"></i> è‡ªå®šä¹‰ç½‘ç«™ç®¡ç†</h3>
                <div class="sites-grid" id="customSitesGrid">
                    <!-- è‡ªå®šä¹‰ç½‘ç«™å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- 5. æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™åŠŸèƒ½ -->
            <div class="settings-section">
                <h3><i class="fas fa-plus-circle"></i> æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™</h3>
                <div class="add-site-form">
                    <div class="form-group">
                        <label for="customSiteName"><i class="fas fa-signature"></i> ç½‘ç«™åç§°</label>
                        <input type="text" id="customSiteName" placeholder="ä¾‹å¦‚ï¼šæˆ‘çš„åšå®¢">
                    </div>
                    
                    <div class="form-group">
                        <label for="customSiteUrl"><i class="fas fa-link"></i> æœç´¢URLæ ¼å¼</label>
                        <input type="text" id="customSiteUrl" placeholder="https://example.com/search?q={keyword}">
                        <div class="form-help">è¯·ä½¿ç”¨ {keyword} ä½œä¸ºå…³é”®è¯å ä½ç¬¦</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="customSiteHomepage"><i class="fas fa-home"></i> å®˜æ–¹ç½‘ç«™</label>
                        <input type="text" id="customSiteHomepage" placeholder="https://example.com">
                        <div class="form-help">ç‚¹å‡»å›¾æ ‡æˆ–åç§°æ—¶å°†æ‰“å¼€æ­¤é“¾æ¥</div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customSiteIcon"><i class="fas fa-icons"></i> å›¾æ ‡</label>
                            <select id="customSiteIcon">
                                <option value="fas fa-search">ğŸ” æœç´¢</option>
                                <option value="fab fa-chrome">ğŸŒ æµè§ˆå™¨</option>
                                <option value="fas fa-shopping-cart">ğŸ›’ è´­ç‰©</option>
                                <option value="fas fa-video">ğŸ¬ è§†é¢‘</option>
                                <option value="fas fa-music">ğŸµ éŸ³ä¹</option>
                                <option value="fas fa-book">ğŸ“š ä¹¦ç±</option>
                                <option value="fas fa-code">ğŸ’» ç¼–ç¨‹</option>
                                <option value="fas fa-gamepad">ğŸ® æ¸¸æˆ</option>
                                <option value="fas fa-newspaper">ğŸ“° æ–°é—»</option>
                                <option value="fas fa-graduation-cap">ğŸ“ å­¦ä¹ </option>
                                <option value="fas fa-paint-brush">ğŸ¨ è®¾è®¡</option>
                                <option value="fas fa-utensils">ğŸ´ ç¾é£Ÿ</option>
                                <option value="fas fa-heart">â¤ï¸ å¥åº·</option>
                                <option value="fas fa-plane">âœˆï¸ æ—…è¡Œ</option>
                                <option value="fas fa-camera">ğŸ“· æ‘„å½±</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="customSiteColor"><i class="fas fa-palette"></i> ä¸»é¢˜è‰²</label>
                            <input type="color" id="customSiteColor" value="#4f46e5">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="customSiteCategory"><i class="fas fa-folder"></i> åˆ†ç±»</label>
                        <select id="customSiteCategory">
                            <option value="custom">è‡ªå®šä¹‰åˆ†ç±»</option>
                            <option value="video">è§†é¢‘</option>
                            <option value="programming">ç¼–ç¨‹</option>
                            <option value="knowledge">çŸ¥è¯†</option>
                            <option value="search">æœç´¢</option>
                            <option value="shopping">è´­ç‰©</option>
                            <option value="social">ç¤¾äº¤</option>
                            <option value="music">éŸ³ä¹</option>
                            <option value="learning">å­¦ä¹ </option>
                            <option value="tools">å·¥å…·</option>
                            <option value="news">æ–°é—»</option>
                            <option value="reading">é˜…è¯»</option>
                            <option value="finance">é‡‘è</option>
                            <option value="health">å¥åº·</option>
                            <option value="travel">æ—…è¡Œ</option>
                            <option value="food">ç¾é£Ÿ</option>
                            <option value="sports">ä½“è‚²</option>
                            <option value="entertainment">å¨±ä¹</option>
                        </select>
                        <input type="text" id="customCategoryInput" class="custom-category-input" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰åˆ†ç±»åç§°">
                    </div>
                    
                    <div class="form-group">
                        <label for="customSiteDesc"><i class="fas fa-comment-alt"></i> æè¿°</label>
                        <input type="text" id="customSiteDesc" placeholder="æè¿°è¿™ä¸ªç½‘ç«™çš„æœç´¢å†…å®¹...">
                    </div>
                    
                    <button class="action-btn primary" id="addCustomSite" style="width: 100%;">
                        <i class="fas fa-plus"></i> æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- é®ç½©å±‚ -->
    <div class="overlay" id="overlay"></div>
    
    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- é¡¶éƒ¨æ§åˆ¶æ  -->
        <div class="top-bar">
            <!-- åˆ†ç±»æ ‡ç­¾ -->
            <div class="category-tabs" id="categoryTabs">
                <!-- åˆ†ç±»æ ‡ç­¾å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <!-- è®¾ç½®æŒ‰é’® -->
            <button class="settings-icon" id="openSettings" title="è®¾ç½®">
                <i class="fas fa-cog"></i>
            </button>
        </div>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content">
            <div class="search-grid" id="searchGrid">
                <!-- æœç´¢å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <!-- æ’åºæç¤º -->
            <div class="sorting-hint disabled" id="sortingHint">
                <i class="fas fa-hand-point-up"></i> æ‹–æ‹½å¡ç‰‡å¯ä»¥è‡ªå®šä¹‰æ’åºé¡ºåº
            </div>
            
            <!-- ç©ºçŠ¶æ€æç¤º -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <i class="fas fa-search-slash"></i>
                <h3>æ²¡æœ‰å¯æ˜¾ç¤ºçš„ç½‘ç«™</h3>
                <p>è¯·æ‰“å¼€è®¾ç½®é¢æ¿ï¼Œé€‰æ‹©ä½ æƒ³è¦æ˜¾ç¤ºçš„ç½‘ç«™</p>
            </div>
        </div>
    </div>

    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥æ¡†ç”¨äºå¯¼å…¥é…ç½® -->
    <input type="file" id="importFile" accept=".json" class="file-input-hidden">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    <script>
        // å®Œæ•´çš„æœç´¢å¼•æ“æ•°æ®åº“ï¼ˆ120+ä¸ªçƒ­é—¨ç½‘ç«™ï¼‰
        const searchEnginesDB = {
            // è§†é¢‘ç±»
            video: [
                {
                    id: 'bilibili',
                    name: 'å“”å“©å“”å“©',
                    url: 'https://search.bilibili.com/all?keyword={keyword}',
                    homepage: 'https://www.bilibili.com',
                    icon: 'fab fa-bilibili',
                    color: '#FB7299',
                    description: 'æœç´¢ç•ªå‰§ã€çŸ¥è¯†ã€UPä¸»...',
                    custom: false
                },
                {
                    id: 'youtube',
                    name: 'YouTube',
                    url: 'https://www.youtube.com/results?search_query={keyword}',
                    homepage: 'https://www.youtube.com',
                    icon: 'fab fa-youtube',
                    color: '#FF0000',
                    description: 'æœç´¢è§†é¢‘ã€éŸ³ä¹ã€æ•™ç¨‹...',
                    custom: false
                },
                {
                    id: 'iqiyi',
                    name: 'çˆ±å¥‡è‰º',
                    url: 'https://so.iqiyi.com/so/q_{keyword}',
                    homepage: 'https://www.iqiyi.com',
                    icon: 'fas fa-play-circle',
                    color: '#00BE06',
                    description: 'æœç´¢ç”µè§†å‰§ã€ç”µå½±ã€ç»¼è‰º...',
                    custom: false
                },
                {
                    id: 'tencentVideo',
                    name: 'è…¾è®¯è§†é¢‘',
                    url: 'https://v.qq.com/x/search?q={keyword}',
                    homepage: 'https://v.qq.com',
                    icon: 'fab fa-tencent',
                    color: '#0DB3FF',
                    description: 'æœç´¢çƒ­æ’­å‰§ã€ç”µå½±ã€åŠ¨æ¼«...',
                    custom: false
                },
                {
                    id: 'youku',
                    name: 'ä¼˜é…·',
                    url: 'https://so.youku.com/search_video/q_{keyword}',
                    homepage: 'https://www.youku.com',
                    icon: 'fas fa-film',
                    color: '#FF6600',
                    description: 'æœç´¢é«˜æ¸…è§†é¢‘ã€å‰§é›†...',
                    custom: false
                },
                {
                    id: 'douyin',
                    name: 'æŠ–éŸ³',
                    url: 'https://www.douyin.com/search/{keyword}',
                    homepage: 'https://www.douyin.com',
                    icon: 'fab fa-tiktok',
                    color: '#000000',
                    description: 'æœç´¢çŸ­è§†é¢‘ã€ç›´æ’­...',
                    custom: false
                },
                {
                    id: 'twitch',
                    name: 'Twitch',
                    url: 'https://www.twitch.tv/search?term={keyword}',
                    homepage: 'https://www.twitch.tv',
                    icon: 'fab fa-twitch',
                    color: '#9146FF',
                    description: 'æœç´¢æ¸¸æˆç›´æ’­...',
                    custom: false
                },
                {
                    id: 'vimeo',
                    name: 'Vimeo',
                    url: 'https://vimeo.com/search?q={keyword}',
                    homepage: 'https://vimeo.com',
                    icon: 'fab fa-vimeo',
                    color: '#1AB7EA',
                    description: 'æœç´¢é«˜æ¸…è§†é¢‘...',
                    custom: false
                },
                {
                    id: 'netflix',
                    name: 'Netflix',
                    url: 'https://www.netflix.com/search?q={keyword}',
                    homepage: 'https://www.netflix.com',
                    icon: 'fas fa-tv',
                    color: '#E50914',
                    description: 'æœç´¢ç”µå½±ã€å‰§é›†...',
                    custom: false
                }
            ],
            
            // ç¼–ç¨‹å¼€å‘ç±»
            programming: [
                {
                    id: 'github',
                    name: 'GitHub',
                    url: 'https://github.com/search?q={keyword}',
                    homepage: 'https://github.com',
                    icon: 'fab fa-github',
                    color: '#181717',
                    description: 'æœç´¢ä»“åº“ã€ä»£ç ã€ç”¨æˆ·...',
                    custom: false
                },
                {
                    id: 'stackoverflow',
                    name: 'Stack Overflow',
                    url: 'https://stackoverflow.com/search?q={keyword}',
                    homepage: 'https://stackoverflow.com',
                    icon: 'fab fa-stack-overflow',
                    color: '#F48024',
                    description: 'æœç´¢ç¼–ç¨‹é—®é¢˜ã€è§£å†³æ–¹æ¡ˆ...',
                    custom: false
                },
                {
                    id: 'gitlab',
                    name: 'GitLab',
                    url: 'https://gitlab.com/search?search={keyword}',
                    homepage: 'https://gitlab.com',
                    icon: 'fab fa-gitlab',
                    color: '#FC6D26',
                    description: 'æœç´¢GitLabé¡¹ç›®ã€ä»£ç ...',
                    custom: false
                },
                {
                    id: 'npm',
                    name: 'npm',
                    url: 'https://www.npmjs.com/search?q={keyword}',
                    homepage: 'https://www.npmjs.com',
                    icon: 'fab fa-npm',
                    color: '#CB3837',
                    description: 'æœç´¢JavaScriptåŒ…...',
                    custom: false
                },
                {
                    id: 'python',
                    name: 'Pythonå®˜æ–¹',
                    url: 'https://docs.python.org/3/search.html?q={keyword}',
                    homepage: 'https://www.python.org',
                    icon: 'fab fa-python',
                    color: '#3776AB',
                    description: 'æœç´¢Pythonæ–‡æ¡£...',
                    custom: false
                },
                {
                    id: 'mdn',
                    name: 'MDN Web Docs',
                    url: 'https://developer.mozilla.org/zh-CN/search?q={keyword}',
                    homepage: 'https://developer.mozilla.org',
                    icon: 'fab fa-mdn',
                    color: '#000000',
                    description: 'æœç´¢Webå¼€å‘æ–‡æ¡£...',
                    custom: false
                },
                {
                    id: 'dockerhub',
                    name: 'Docker Hub',
                    url: 'https://hub.docker.com/search?q={keyword}',
                    homepage: 'https://hub.docker.com',
                    icon: 'fab fa-docker',
                    color: '#2496ED',
                    description: 'æœç´¢Dockeré•œåƒ...',
                    custom: false
                },
                {
                    id: 'leetcode',
                    name: 'LeetCode',
                    url: 'https://leetcode.com/problemset/all/?search={keyword}',
                    homepage: 'https://leetcode.com',
                    icon: 'fas fa-code',
                    color: '#FFA116',
                    description: 'æœç´¢ç®—æ³•é¢˜ç›®...',
                    custom: false
                },
                {
                    id: 'codepen',
                    name: 'CodePen',
                    url: 'https://codepen.io/search/pens?q={keyword}',
                    homepage: 'https://codepen.io',
                    icon: 'fab fa-codepen',
                    color: '#000000',
                    description: 'æœç´¢å‰ç«¯ä»£ç ç¤ºä¾‹...',
                    custom: false
                },
                {
                    id: 'jsfiddle',
                    name: 'JSFiddle',
                    url: 'https://jsfiddle.net/search/?query={keyword}',
                    homepage: 'https://jsfiddle.net',
                    icon: 'fas fa-code',
                    color: '#0084FF',
                    description: 'æœç´¢JavaScriptä»£ç ç‰‡æ®µ...',
                    custom: false
                },
                {
                    id: 'stackblitz',
                    name: 'StackBlitz',
                    url: 'https://stackblitz.com/search?q={keyword}',
                    homepage: 'https://stackblitz.com',
                    icon: 'fas fa-bolt',
                    color: '#1263F1',
                    description: 'æœç´¢åœ¨çº¿å¼€å‘ç¯å¢ƒ...',
                    custom: false
                },
                {
                    id: 'replit',
                    name: 'Replit',
                    url: 'https://replit.com/search?q={keyword}',
                    homepage: 'https://replit.com',
                    icon: 'fas fa-terminal',
                    color: '#667881',
                    description: 'æœç´¢åœ¨çº¿ç¼–ç¨‹é¡¹ç›®...',
                    custom: false
                }
            ],
            
            // çŸ¥è¯†ç¤¾åŒºç±»
            knowledge: [
                {
                    id: 'zhihu',
                    name: 'çŸ¥ä¹',
                    url: 'https://www.zhihu.com/search?type=content&q={keyword}',
                    homepage: 'https://www.zhihu.com',
                    icon: 'fab fa-zhihu',
                    color: '#0066FF',
                    description: 'æœç´¢é—®é¢˜ã€è¯é¢˜ã€ç”¨æˆ·...',
                    custom: false
                },
                {
                    id: 'baiduBaike',
                    name: 'ç™¾åº¦ç™¾ç§‘',
                    url: 'https://baike.baidu.com/item/{keyword}',
                    homepage: 'https://baike.baidu.com',
                    icon: 'fas fa-book',
                    color: '#2319DC',
                    description: 'æœç´¢ç™¾ç§‘è¯æ¡ã€çŸ¥è¯†...',
                    custom: false
                },
                {
                    id: 'wikipedia',
                    name: 'ç»´åŸºç™¾ç§‘',
                    url: 'https://zh.wikipedia.org/wiki/Special:æœç´¢?search={keyword}',
                    homepage: 'https://zh.wikipedia.org',
                    icon: 'fab fa-wikipedia-w',
                    color: '#000000',
                    description: 'æœç´¢å…¨çƒçŸ¥è¯†ç™¾ç§‘...',
                    custom: false
                },
                {
                    id: 'douban',
                    name: 'è±†ç“£',
                    url: 'https://www.douban.com/search?q={keyword}',
                    homepage: 'https://www.douban.com',
                    icon: 'fas fa-star',
                    color: '#007722',
                    description: 'æœç´¢ä¹¦ç±ã€ç”µå½±ã€éŸ³ä¹...',
                    custom: false
                },
                {
                    id: 'juejin',
                    name: 'æ˜é‡‘',
                    url: 'https://juejin.cn/search?query={keyword}',
                    homepage: 'https://juejin.cn',
                    icon: 'fas fa-gem',
                    color: '#007FFF',
                    description: 'æœç´¢æŠ€æœ¯æ–‡ç« ã€åˆ†äº«...',
                    custom: false
                },
                {
                    id: 'csdn',
                    name: 'CSDN',
                    url: 'https://so.csdn.net/so/search?q={keyword}',
                    homepage: 'https://www.csdn.net',
                    icon: 'fas fa-laptop-code',
                    color: '#D42B32',
                    description: 'æœç´¢æŠ€æœ¯åšå®¢ã€æ•™ç¨‹...',
                    custom: false
                },
                {
                    id: 'segmentfault',
                    name: 'æ€å¦',
                    url: 'https://segmentfault.com/search?q={keyword}',
                    homepage: 'https://segmentfault.com',
                    icon: 'fas fa-question-circle',
                    color: '#26B766',
                    description: 'æœç´¢æŠ€æœ¯é—®ç­”...',
                    custom: false
                },
                {
                    id: 'infoq',
                    name: 'InfoQ',
                    url: 'https://www.infoq.cn/search?q={keyword}',
                    homepage: 'https://www.infoq.cn',
                    icon: 'fas fa-newspaper',
                    color: '#00A8FF',
                    description: 'æœç´¢æŠ€æœ¯èµ„è®¯...',
                    custom: false
                },
                {
                    id: 'oschina',
                    name: 'å¼€æºä¸­å›½',
                    url: 'https://www.oschina.net/search?q={keyword}',
                    homepage: 'https://www.oschina.net',
                    icon: 'fas fa-code-branch',
                    color: '#21B351',
                    description: 'æœç´¢å¼€æºé¡¹ç›®...',
                    custom: false
                },
                {
                    id: 'v2ex',
                    name: 'V2EX',
                    url: 'https://www.v2ex.com/?q={keyword}',
                    homepage: 'https://www.v2ex.com',
                    icon: 'fas fa-comments',
                    color: '#CCCCCC',
                    description: 'æœç´¢æŠ€æœ¯ç¤¾åŒºè®¨è®º...',
                    custom: false
                },
                {
                    id: 'quora',
                    name: 'Quora',
                    url: 'https://www.quora.com/search?q={keyword}',
                    homepage: 'https://www.quora.com',
                    icon: 'fab fa-quora',
                    color: '#B92B27',
                    description: 'æœç´¢è‹±æ–‡é—®ç­”...',
                    custom: false
                }
            ],
            
            // æœç´¢å¼•æ“ç±»
            search: [
                {
                    id: 'baidu',
                    name: 'ç™¾åº¦',
                    url: 'https://www.baidu.com/s?wd={keyword}',
                    homepage: 'https://www.baidu.com',
                    icon: 'fas fa-search',
                    color: '#2319DC',
                    description: 'æœç´¢ä»»ä½•å†…å®¹...',
                    custom: false
                },
                {
                    id: 'google',
                    name: 'Google',
                    url: 'https://www.google.com/search?q={keyword}',
                    homepage: 'https://www.google.com',
                    icon: 'fab fa-google',
                    color: '#4285F4',
                    description: 'æœç´¢å…¨çƒä¿¡æ¯...',
                    custom: false
                },
                {
                    id: 'bing',
                    name: 'Bing',
                    url: 'https://www.bing.com/search?q={keyword}',
                    homepage: 'https://www.bing.com',
                    icon: 'fab fa-microsoft',
                    color: '#007DAA',
                    description: 'å¾®è½¯æœç´¢å¼•æ“...',
                    custom: false
                },
                {
                    id: 'sogou',
                    name: 'æœç‹—',
                    url: 'https://www.sogou.com/web?query={keyword}',
                    homepage: 'https://www.sogou.com',
                    icon: 'fas fa-paw',
                    color: '#FB6027',
                    description: 'æœç‹—æœç´¢...',
                    custom: false
                },
                {
                    id: 'duckduckgo',
                    name: 'DuckDuckGo',
                    url: 'https://duckduckgo.com/?q={keyword}',
                    homepage: 'https://duckduckgo.com',
                    icon: 'fas fa-duck',
                    color: '#DE5833',
                    description: 'éšç§æœç´¢å¼•æ“...',
                    custom: false
                },
                {
                    id: 'yandex',
                    name: 'Yandex',
                    url: 'https://yandex.com/search/?text={keyword}',
                    homepage: 'https://yandex.com',
                    icon: 'fas fa-search',
                    color: '#FF0000',
                    description: 'ä¿„ç½—æ–¯æœç´¢å¼•æ“...',
                    custom: false
                },
                {
                    id: 'yahoo',
                    name: 'Yahoo',
                    url: 'https://search.yahoo.com/search?p={keyword}',
                    homepage: 'https://search.yahoo.com',
                    icon: 'fab fa-yahoo',
                    color: '#6001D2',
                    description: 'é›…è™æœç´¢...',
                    custom: false
                }
            ],
            
            // è´­ç‰©ç±»
            shopping: [
                {
                    id: 'taobao',
                    name: 'æ·˜å®',
                    url: 'https://s.taobao.com/search?q={keyword}',
                    homepage: 'https://www.taobao.com',
                    icon: 'fas fa-shopping-cart',
                    color: '#FF4400',
                    description: 'æœç´¢å•†å“ã€åº—é“º...',
                    custom: false
                },
                {
                    id: 'jd',
                    name: 'äº¬ä¸œ',
                    url: 'https://search.jd.com/Search?keyword={keyword}',
                    homepage: 'https://www.jd.com',
                    icon: 'fas fa-store',
                    color: '#E3330F',
                    description: 'æœç´¢æ•°ç ã€å®¶ç”µ...',
                    custom: false
                },
                {
                    id: 'pinduoduo',
                    name: 'æ‹¼å¤šå¤š',
                    url: 'https://mobile.yangkeduo.com/search_result.html?search_key={keyword}',
                    homepage: 'https://www.pinduoduo.com',
                    icon: 'fas fa-shopping-basket',
                    color: '#E42C2E',
                    description: 'æœç´¢æ‹¼å›¢å•†å“...',
                    custom: false
                },
                {
                    id: 'amazon',
                    name: 'äºšé©¬é€Š',
                    url: 'https://www.amazon.com/s?k={keyword}',
                    homepage: 'https://www.amazon.com',
                    icon: 'fab fa-amazon',
                    color: '#FF9900',
                    description: 'æœç´¢å…¨çƒå•†å“...',
                    custom: false
                },
                {
                    id: 'tmall',
                    name: 'å¤©çŒ«',
                    url: 'https://list.tmall.com/search_product.htm?q={keyword}',
                    homepage: 'https://www.tmall.com',
                    icon: 'fas fa-crown',
                    color: '#FF0033',
                    description: 'æœç´¢å“ç‰Œå•†å“...',
                    custom: false
                },
                {
                    id: '1688',
                    name: '1688',
                    url: 'https://s.1688.com/selloffer/offer_search.htm?keywords={keyword}',
                    homepage: 'https://www.1688.com',
                    icon: 'fas fa-industry',
                    color: '#FF6A00',
                    description: 'æœç´¢æ‰¹å‘å•†å“...',
                    custom: false
                },
                {
                    id: 'aliexpress',
                    name: 'AliExpress',
                    url: 'https://www.aliexpress.com/wholesale?SearchText={keyword}',
                    homepage: 'https://www.aliexpress.com',
                    icon: 'fas fa-globe',
                    color: '#FF6A00',
                    description: 'æœç´¢å…¨çƒé€Ÿå–é€š...',
                    custom: false
                },
                {
                    id: 'ebay',
                    name: 'eBay',
                    url: 'https://www.ebay.com/sch/i.html?_nkw={keyword}',
                    homepage: 'https://www.ebay.com',
                    icon: 'fab fa-ebay',
                    color: '#E53238',
                    description: 'æœç´¢æ‹å–å•†å“...',
                    custom: false
                },
                {
                    id: 'walmart',
                    name: 'Walmart',
                    url: 'https://www.walmart.com/search?q={keyword}',
                    homepage: 'https://www.walmart.com',
                    icon: 'fas fa-store',
                    color: '#0071CE',
                    description: 'æœç´¢æ²ƒå°”ç›å•†å“...',
                    custom: false
                },
                {
                    id: 'bestbuy',
                    name: 'Best Buy',
                    url: 'https://www.bestbuy.com/site/searchpage.jsp?st={keyword}',
                    homepage: 'https://www.bestbuy.com',
                    icon: 'fas fa-laptop',
                    color: '#0046BE',
                    description: 'æœç´¢ç”µå­äº§å“...',
                    custom: false
                }
            ],
            
            // ç¤¾äº¤åª’ä½“ç±»
            social: [
                {
                    id: 'weibo',
                    name: 'å¾®åš',
                    url: 'https://s.weibo.com/weibo?q={keyword}',
                    homepage: 'https://weibo.com',
                    icon: 'fab fa-weibo',
                    color: '#DF2029',
                    description: 'æœç´¢çƒ­ç‚¹ã€è¯é¢˜...',
                    custom: false
                },
                {
                    id: 'xiaohongshu',
                    name: 'å°çº¢ä¹¦',
                    url: 'https://www.xiaohongshu.com/search_result?keyword={keyword}',
                    homepage: 'https://www.xiaohongshu.com',
                    icon: 'fas fa-book-open',
                    color: '#FF2442',
                    description: 'æœç´¢ç¬”è®°ã€æ”»ç•¥...',
                    custom: false
                },
                {
                    id: 'twitter',
                    name: 'Twitter',
                    url: 'https://twitter.com/search?q={keyword}',
                    homepage: 'https://twitter.com',
                    icon: 'fab fa-twitter',
                    color: '#1DA1F2',
                    description: 'æœç´¢æ¨æ–‡ã€è¯é¢˜...',
                    custom: false
                },
                {
                    id: 'facebook',
                    name: 'Facebook',
                    url: 'https://www.facebook.com/search/top?q={keyword}',
                    homepage: 'https://www.facebook.com',
                    icon: 'fab fa-facebook',
                    color: '#1877F2',
                    description: 'æœç´¢ç¤¾äº¤å†…å®¹...',
                    custom: false
                },
                {
                    id: 'instagram',
                    name: 'Instagram',
                    url: 'https://www.instagram.com/explore/tags/{keyword}/',
                    homepage: 'https://www.instagram.com',
                    icon: 'fab fa-instagram',
                    color: '#E4405F',
                    description: 'æœç´¢å›¾ç‰‡ã€æ ‡ç­¾...',
                    custom: false
                },
                {
                    id: 'linkedin',
                    name: 'LinkedIn',
                    url: 'https://www.linkedin.com/search/results/all/?keywords={keyword}',
                    homepage: 'https://www.linkedin.com',
                    icon: 'fab fa-linkedin',
                    color: '#0A66C2',
                    description: 'æœç´¢èŒåœºä¿¡æ¯...',
                    custom: false
                },
                {
                    id: 'reddit',
                    name: 'Reddit',
                    url: 'https://www.reddit.com/search/?q={keyword}',
                    homepage: 'https://www.reddit.com',
                    icon: 'fab fa-reddit',
                    color: '#FF4500',
                    description: 'æœç´¢ç¤¾åŒºè®¨è®º...',
                    custom: false
                },
                {
                    id: 'pinterest',
                    name: 'Pinterest',
                    url: 'https://www.pinterest.com/search/pins/?q={keyword}',
                    homepage: 'https://www.pinterest.com',
                    icon: 'fab fa-pinterest',
                    color: '#E60023',
                    description: 'æœç´¢å›¾ç‰‡çµæ„Ÿ...',
                    custom: false
                },
                {
                    id: 'tumblr',
                    name: 'Tumblr',
                    url: 'https://www.tumblr.com/search/{keyword}',
                    homepage: 'https://www.tumblr.com',
                    icon: 'fab fa-tumblr',
                    color: '#001935',
                    description: 'æœç´¢åšå®¢å†…å®¹...',
                    custom: false
                }
            ],
            
            // éŸ³ä¹ç±»
            music: [
                {
                    id: 'neteaseMusic',
                    name: 'ç½‘æ˜“äº‘éŸ³ä¹',
                    url: 'https://music.163.com/#/search/m/?s={keyword}',
                    homepage: 'https://music.163.com',
                    icon: 'fas fa-music',
                    color: '#E60026',
                    description: 'æœç´¢æ­Œæ›²ã€æ­Œå•...',
                    custom: false
                },
                {
                    id: 'qqMusic',
                    name: 'QQéŸ³ä¹',
                    url: 'https://y.qq.com/n/ryqq/search?w={keyword}',
                    homepage: 'https://y.qq.com',
                    icon: 'fab fa-qq',
                    color: '#31C27C',
                    description: 'æœç´¢éŸ³ä¹ã€MV...',
                    custom: false
                },
                {
                    id: 'kugou',
                    name: 'é…·ç‹—éŸ³ä¹',
                    url: 'https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord={keyword}',
                    homepage: 'https://www.kugou.com',
                    icon: 'fas fa-headphones',
                    color: '#3B9DD9',
                    description: 'æœç´¢æ­Œæ›²ã€æ­Œè¯...',
                    custom: false
                },
                {
                    id: 'spotify',
                    name: 'Spotify',
                    url: 'https://open.spotify.com/search/{keyword}',
                    homepage: 'https://open.spotify.com',
                    icon: 'fab fa-spotify',
                    color: '#1DB954',
                    description: 'æœç´¢å…¨çƒéŸ³ä¹...',
                    custom: false
                },
                {
                    id: 'youtubeMusic',
                    name: 'YouTube Music',
                    url: 'https://music.youtube.com/search?q={keyword}',
                    homepage: 'https://music.youtube.com',
                    icon: 'fab fa-youtube',
                    color: '#FF0000',
                    description: 'æœç´¢YouTubeéŸ³ä¹...',
                    custom: false
                },
                {
                    id: 'appleMusic',
                    name: 'Apple Music',
                    url: 'https://music.apple.com/us/search?term={keyword}',
                    homepage: 'https://music.apple.com',
                    icon: 'fab fa-apple',
                    color: '#FA243C',
                    description: 'æœç´¢AppleéŸ³ä¹...',
                    custom: false
                },
                {
                    id: 'soundcloud',
                    name: 'SoundCloud',
                    url: 'https://soundcloud.com/search?q={keyword}',
                    homepage: 'https://soundcloud.com',
                    icon: 'fab fa-soundcloud',
                    color: '#FF3300',
                    description: 'æœç´¢ç‹¬ç«‹éŸ³ä¹...',
                    custom: false
                },
                {
                    id: 'bandcamp',
                    name: 'Bandcamp',
                    url: 'https://bandcamp.com/search?q={keyword}',
                    homepage: 'https://bandcamp.com',
                    icon: 'fas fa-compact-disc',
                    color: '#629AA9',
                    description: 'æœç´¢ç‹¬ç«‹è‰ºæœ¯å®¶...',
                    custom: false
                }
            ],
            
            // å­¦ä¹ ç±»
            learning: [
                {
                    id: 'coursera',
                    name: 'Coursera',
                    url: 'https://www.coursera.org/search?query={keyword}',
                    homepage: 'https://www.coursera.org',
                    icon: 'fas fa-graduation-cap',
                    color: '#2A73CC',
                    description: 'æœç´¢åœ¨çº¿è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'edx',
                    name: 'edX',
                    url: 'https://www.edx.org/search?q={keyword}',
                    homepage: 'https://www.edx.org',
                    icon: 'fas fa-university',
                    color: '#02262B',
                    description: 'æœç´¢å¤§å­¦è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'udemy',
                    name: 'Udemy',
                    url: 'https://www.udemy.com/courses/search/?src=ukw&q={keyword}',
                    homepage: 'https://www.udemy.com',
                    icon: 'fas fa-chalkboard-teacher',
                    color: '#A435F0',
                    description: 'æœç´¢æŠ€èƒ½è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'khan',
                    name: 'å¯æ±—å­¦é™¢',
                    url: 'https://www.khanacademy.org/search?page_search_query={keyword}',
                    homepage: 'https://www.khanacademy.org',
                    icon: 'fas fa-school',
                    color: '#14BF96',
                    description: 'æœç´¢å…è´¹æ•™è‚²å†…å®¹...',
                    custom: false
                },
                {
                    id: 'icourse163',
                    name: 'ä¸­å›½å¤§å­¦MOOC',
                    url: 'https://www.icourse163.org/search.htm?search={keyword}',
                    homepage: 'https://www.icourse163.org',
                    icon: 'fas fa-laptop-house',
                    color: '#D42B32',
                    description: 'æœç´¢å›½å†…å¤§å­¦è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'xuetangx',
                    name: 'å­¦å ‚åœ¨çº¿',
                    url: 'https://next.xuetangx.com/search?query={keyword}',
                    homepage: 'https://www.xuetangx.com',
                    icon: 'fas fa-chalkboard',
                    color: '#2D6CA2',
                    description: 'æœç´¢æ¸…åè¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'skillshare',
                    name: 'Skillshare',
                    url: 'https://www.skillshare.com/search?query={keyword}',
                    homepage: 'https://www.skillshare.com',
                    icon: 'fas fa-paint-brush',
                    color: '#00FF99',
                    description: 'æœç´¢åˆ›æ„æŠ€èƒ½è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'pluralsight',
                    name: 'Pluralsight',
                    url: 'https://www.pluralsight.com/search?q={keyword}',
                    homepage: 'https://www.pluralsight.com',
                    icon: 'fas fa-desktop',
                    color: '#F15A2B',
                    description: 'æœç´¢æŠ€æœ¯åŸ¹è®­è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'udacity',
                    name: 'Udacity',
                    url: 'https://www.udacity.com/courses/all?search={keyword}',
                    homepage: 'https://www.udacity.com',
                    icon: 'fas fa-rocket',
                    color: '#02B3E4',
                    description: 'æœç´¢çº³ç±³å­¦ä½è¯¾ç¨‹...',
                    custom: false
                },
                {
                    id: 'futurelearn',
                    name: 'FutureLearn',
                    url: 'https://www.futurelearn.com/search?q={keyword}',
                    homepage: 'https://www.futurelearn.com',
                    icon: 'fas fa-globe-europe',
                    color: '#DE0D6C',
                    description: 'æœç´¢è‹±å›½å¤§å­¦è¯¾ç¨‹...',
                    custom: false
                }
            ],
            
            // å·¥å…·ç±»
            tools: [
                {
                    id: 'deepL',
                    name: 'DeepLç¿»è¯‘',
                    url: 'https://www.deepl.com/translator#auto/auto/{keyword}',
                    homepage: 'https://www.deepl.com/translator',
                    icon: 'fas fa-language',
                    color: '#0D2B4E',
                    description: 'ç¿»è¯‘æ–‡æœ¬å†…å®¹...',
                    custom: false
                },
                {
                    id: 'googleTranslate',
                    name: 'è°·æ­Œç¿»è¯‘',
                    url: 'https://translate.google.com/?sl=auto&tl=zh-CN&text={keyword}',
                    homepage: 'https://translate.google.com',
                    icon: 'fas fa-exchange-alt',
                    color: '#4285F4',
                    description: 'å¤šè¯­è¨€ç¿»è¯‘...',
                    custom: false
                },
                {
                    id: 'wolframalpha',
                    name: 'WolframAlpha',
                    url: 'https://www.wolframalpha.com/input?i={keyword}',
                    homepage: 'https://www.wolframalpha.com',
                    icon: 'fas fa-square-root-alt',
                    color: '#D10C0C',
                    description: 'è®¡ç®—ã€çŸ¥è¯†å¼•æ“...',
                    custom: false
                },
                {
                    id: 'canva',
                    name: 'Canva',
                    url: 'https://www.canva.com/templates/search/{keyword}',
                    homepage: 'https://www.canva.com',
                    icon: 'fas fa-palette',
                    color: '#00C4CC',
                    description: 'æœç´¢è®¾è®¡æ¨¡æ¿...',
                    custom: false
                },
                {
                    id: 'figma',
                    name: 'Figmaç¤¾åŒº',
                    url: 'https://www.figma.com/community/search?resource_type=mixed&sort_by=popular&query={keyword}',
                    homepage: 'https://www.figma.com',
                    icon: 'fab fa-figma',
                    color: '#F24E1E',
                    description: 'æœç´¢è®¾è®¡èµ„æº...',
                    custom: false
                },
                {
                    id: 'unsplash',
                    name: 'Unsplash',
                    url: 'https://unsplash.com/s/photos/{keyword}',
                    homepage: 'https://unsplash.com',
                    icon: 'fas fa-camera',
                    color: '#000000',
                    description: 'æœç´¢é«˜è´¨é‡å›¾ç‰‡...',
                    custom: false
                },
                {
                    id: 'pexels',
                    name: 'Pexels',
                    url: 'https://www.pexels.com/zh-cn/search/{keyword}',
                    homepage: 'https://www.pexels.com',
                    icon: 'fas fa-images',
                    color: '#05A081',
                    description: 'æœç´¢å…è´¹å›¾ç‰‡...',
                    custom: false
                },
                {
                    id: 'pixabay',
                    name: 'Pixabay',
                    url: 'https://pixabay.com/images/search/{keyword}',
                    homepage: 'https://pixabay.com',
                    icon: 'fas fa-image',
                    color: '#2EC66D',
                    description: 'æœç´¢å…è´¹å›¾åº“...',
                    custom: false
                },
                {
                    id: 'flaticon',
                    name: 'Flaticon',
                    url: 'https://www.flaticon.com/search?word={keyword}',
                    homepage: 'https://www.flaticon.com',
                    icon: 'fas fa-icons',
                    color: '#2B2D42',
                    description: 'æœç´¢å›¾æ ‡...',
                    custom: false
                },
                {
                    id: 'icons8',
                    name: 'Icons8',
                    url: 'https://icons8.com/icons/set/{keyword}',
                    homepage: 'https://icons8.com',
                    icon: 'fas fa-icons',
                    color: '#1FB141',
                    description: 'æœç´¢å›¾æ ‡åº“...',
                    custom: false
                }
            ],
            
            // æ–°é—»èµ„è®¯ç±»
            news: [
                {
                    id: 'toutiao',
                    name: 'ä»Šæ—¥å¤´æ¡',
                    url: 'https://so.toutiao.com/search?keyword={keyword}',
                    homepage: 'https://www.toutiao.com',
                    icon: 'fas fa-newspaper',
                    color: '#E63939',
                    description: 'æœç´¢æ–°é—»èµ„è®¯...',
                    custom: false
                },
                {
                    id: 'bbc',
                    name: 'BBCæ–°é—»',
                    url: 'https://www.bbc.co.uk/search?q={keyword}',
                    homepage: 'https://www.bbc.co.uk',
                    icon: 'fas fa-broadcast-tower',
                    color: '#B80000',
                    description: 'æœç´¢å›½é™…æ–°é—»...',
                    custom: false
                },
                {
                    id: 'cnn',
                    name: 'CNN',
                    url: 'https://edition.cnn.com/search?q={keyword}',
                    homepage: 'https://edition.cnn.com',
                    icon: 'fas fa-tv',
                    color: '#CC0000',
                    description: 'æœç´¢ç¾å›½æ–°é—»...',
                    custom: false
                },
                {
                    id: 'reuters',
                    name: 'è·¯é€ç¤¾',
                    url: 'https://www.reuters.com/search/news?blob={keyword}',
                    homepage: 'https://www.reuters.com',
                    icon: 'fas fa-globe-americas',
                    color: '#FF8000',
                    description: 'æœç´¢è´¢ç»æ–°é—»...',
                    custom: false
                },
                {
                    id: 'nytimes',
                    name: 'çº½çº¦æ—¶æŠ¥',
                    url: 'https://www.nytimes.com/search?query={keyword}',
                    homepage: 'https://www.nytimes.com',
                    icon: 'fas fa-newspaper',
                    color: '#000000',
                    description: 'æœç´¢çº½çº¦æ—¶æŠ¥æ–°é—»...',
                    custom: false
                },
                {
                    id: 'theguardian',
                    name: 'å«æŠ¥',
                    url: 'https://www.theguardian.com/search?q={keyword}',
                    homepage: 'https://www.theguardian.com',
                    icon: 'fas fa-newspaper',
                    color: '#052962',
                    description: 'æœç´¢è‹±å›½æ–°é—»...',
                    custom: false
                },
                {
                    id: 'bloomberg',
                    name: 'å½­åšç¤¾',
                    url: 'https://www.bloomberg.com/search?query={keyword}',
                    homepage: 'https://www.bloomberg.com',
                    icon: 'fas fa-chart-line',
                    color: '#000000',
                    description: 'æœç´¢è´¢ç»æ–°é—»...',
                    custom: false
                }
            ],
            
            // é˜…è¯»ç±»
            reading: [
                {
                    id: 'zhihuRead',
                    name: 'çŸ¥ä¹ç›é€‰',
                    url: 'https://www.zhihu.com/search?type=content&q={keyword}',
                    homepage: 'https://www.zhihu.com',
                    icon: 'fas fa-book-open',
                    color: '#0066FF',
                    description: 'æœç´¢æ·±åº¦é˜…è¯»å†…å®¹...',
                    custom: false
                },
                {
                    id: 'weixinRead',
                    name: 'å¾®ä¿¡è¯»ä¹¦',
                    url: 'https://weread.qq.com/web/search/search?keyword={keyword}',
                    homepage: 'https://weread.qq.com',
                    icon: 'fab fa-weixin',
                    color: '#07C160',
                    description: 'æœç´¢ç”µå­ä¹¦...',
                    custom: false
                },
                {
                    id: 'amazonKindle',
                    name: 'Amazon Kindle',
                    url: 'https://www.amazon.com/s?k={keyword}&i=digital-text',
                    homepage: 'https://www.amazon.com',
                    icon: 'fas fa-book',
                    color: '#00A8E1',
                    description: 'æœç´¢Kindleç”µå­ä¹¦...',
                    custom: false
                },
                {
                    id: 'goodreads',
                    name: 'Goodreads',
                    url: 'https://www.goodreads.com/search?q={keyword}',
                    homepage: 'https://www.goodreads.com',
                    icon: 'fab fa-goodreads',
                    color: '#553B08',
                    description: 'æœç´¢ä¹¦ç±è¯„ä»·...',
                    custom: false
                },
                {
                    id: 'medium',
                    name: 'Medium',
                    url: 'https://medium.com/search?q={keyword}',
                    homepage: 'https://medium.com',
                    icon: 'fab fa-medium',
                    color: '#000000',
                    description: 'æœç´¢ä¼˜è´¨æ–‡ç« ...',
                    custom: false
                }
            ],
            
            // é‡‘èç±»
            finance: [
                {
                    id: 'eastmoney',
                    name: 'ä¸œæ–¹è´¢å¯Œ',
                    url: 'https://so.eastmoney.com/web/s?keyword={keyword}',
                    homepage: 'https://www.eastmoney.com',
                    icon: 'fas fa-chart-line',
                    color: '#D32F2F',
                    description: 'æœç´¢è‚¡ç¥¨ã€è´¢ç»...',
                    custom: false
                },
                {
                    id: 'sinaFinance',
                    name: 'æ–°æµªè´¢ç»',
                    url: 'https://search.sina.com.cn/?q={keyword}',
                    homepage: 'https://finance.sina.com.cn',
                    icon: 'fas fa-yen-sign',
                    color: '#E6162D',
                    description: 'æœç´¢è´¢ç»èµ„è®¯...',
                    custom: false
                },
                {
                    id: 'hexun',
                    name: 'å’Œè®¯ç½‘',
                    url: 'https://search.hexun.com/default.html?key={keyword}',
                    homepage: 'https://www.hexun.com',
                    icon: 'fas fa-chart-bar',
                    color: '#0C4DA2',
                    description: 'æœç´¢è´¢ç»æ•°æ®...',
                    custom: false
                },
                {
                    id: 'investing',
                    name: 'Investing.com',
                    url: 'https://www.investing.com/search/?q={keyword}',
                    homepage: 'https://www.investing.com',
                    icon: 'fas fa-globe',
                    color: '#0B5AA9',
                    description: 'æœç´¢å…¨çƒæŠ•èµ„ä¿¡æ¯...',
                    custom: false
                },
                {
                    id: 'yahooFinance',
                    name: 'Yahooè´¢ç»',
                    url: 'https://finance.yahoo.com/quote/{keyword}',
                    homepage: 'https://finance.yahoo.com',
                    icon: 'fab fa-yahoo',
                    color: '#6001D2',
                    description: 'æœç´¢ç¾è‚¡ä¿¡æ¯...',
                    custom: false
                }
            ],
            
            // å¥åº·ç±»
            health: [
                {
                    id: 'webmd',
                    name: 'WebMD',
                    url: 'https://www.webmd.com/search/search_results/default.aspx?query={keyword}',
                    homepage: 'https://www.webmd.com',
                    icon: 'fas fa-heartbeat',
                    color: '#7AC143',
                    description: 'æœç´¢åŒ»ç–—å¥åº·ä¿¡æ¯...',
                    custom: false
                },
                {
                    id: 'mayoclinic',
                    name: 'Mayo Clinic',
                    url: 'https://www.mayoclinic.org/search/search-results?q={keyword}',
                    homepage: 'https://www.mayoclinic.org',
                    icon: 'fas fa-hospital',
                    color: '#004B87',
                    description: 'æœç´¢åŒ»å­¦ä¿¡æ¯...',
                    custom: false
                },
                {
                    id: 'healthline',
                    name: 'Healthline',
                    url: 'https://www.healthline.com/search?q={keyword}',
                    homepage: 'https://www.healthline.com',
                    icon: 'fas fa-stethoscope',
                    color: '#00B67A',
                    description: 'æœç´¢å¥åº·èµ„è®¯...',
                    custom: false
                },
                {
                    id: 'who',
                    name: 'ä¸–ç•Œå«ç”Ÿç»„ç»‡',
                    url: 'https://www.who.int/search?q={keyword}',
                    homepage: 'https://www.who.int',
                    icon: 'fas fa-globe-americas',
                    color: '#0093D5',
                    description: 'æœç´¢å…¨çƒå¥åº·ä¿¡æ¯...',
                    custom: false
                }
            ],
            
            // è‡ªå®šä¹‰ç½‘ç«™ç±»
            custom: []
        };

        // ç”¨æˆ·è®¾ç½®ç®¡ç†
        class SettingsManager {
            constructor() {
                this.settings = {
                    enabledSites: {},
                    siteOrder: {
                        // æ¯ä¸ªåˆ†ç±»ç‹¬ç«‹æ’åºï¼ŒåŒ…æ‹¬'all'
                        all: [],
                        video: [],
                        programming: [],
                        knowledge: [],
                        search: [],
                        shopping: [],
                        social: [],
                        music: [],
                        learning: [],
                        tools: [],
                        news: [],
                        reading: [],
                        finance: [],
                        health: [],
                        custom: []
                    },
                    customSites: [],
                    customCategories: [], // å­˜å‚¨è‡ªå®šä¹‰åˆ†ç±»
                    features: {
                        enableSort: false,
                        enableHide: false
                    },
                    defaultCategory: 'all'
                };
                this.loadSettings();
            }
            
            loadSettings() {
                const saved = localStorage.getItem('searchStartPageSettings');
                if (saved) {
                    try {
                        const parsed = JSON.parse(saved);
                        this.settings = {
                            ...this.settings,
                            ...parsed,
                            features: {
                                ...this.settings.features,
                                ...(parsed.features || {})
                            },
                            // ç¡®ä¿siteOrderæœ‰æ‰€æœ‰åˆ†ç±»
                            siteOrder: {
                                ...this.settings.siteOrder,
                                ...(parsed.siteOrder || {})
                            }
                        };
                    } catch (e) {
                        console.error('åŠ è½½è®¾ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤è®¾ç½®:', e);
                        this.initializeDefaultSettings();
                    }
                } else {
                    this.initializeDefaultSettings();
                }
                
                // ç¡®ä¿è‡ªå®šä¹‰ç½‘ç«™è¢«åŠ è½½åˆ°æ•°æ®åº“ä¸­
                if (this.settings.customSites && this.settings.customSites.length > 0) {
                    searchEnginesDB.custom = this.settings.customSites;
                }
                
                // ç¡®ä¿æ‰€æœ‰é»˜è®¤ç½‘ç«™éƒ½è¢«å¯ç”¨
                this.ensureDefaultSitesEnabled();
            }
            
            initializeDefaultSettings() {
                this.enableAllDefaultSites();
                this.initializeDefaultOrder();
            }
            
            saveSettings() {
                // ä¿å­˜è‡ªå®šä¹‰ç½‘ç«™åˆ°è®¾ç½®ä¸­
                this.settings.customSites = searchEnginesDB.custom;
                try {
                    localStorage.setItem('searchStartPageSettings', JSON.stringify(this.settings));
                } catch (e) {
                    console.error('ä¿å­˜è®¾ç½®å¤±è´¥:', e);
                }
            }
            
            enableAllDefaultSites() {
                this.settings.enabledSites = {};
                for (const category in searchEnginesDB) {
                    if (category !== 'custom') {
                        searchEnginesDB[category].forEach(site => {
                            this.settings.enabledSites[site.id] = true;
                        });
                    }
                }
            }
            
            ensureDefaultSitesEnabled() {
                // ç¡®ä¿æ‰€æœ‰é»˜è®¤ç½‘ç«™éƒ½åœ¨enabledSitesä¸­æœ‰è®°å½•
                for (const category in searchEnginesDB) {
                    if (category !== 'custom') {
                        searchEnginesDB[category].forEach(site => {
                            if (this.settings.enabledSites[site.id] === undefined) {
                                this.settings.enabledSites[site.id] = true;
                            }
                        });
                    }
                }
            }
            
            initializeDefaultOrder() {
                // ä¸ºæ¯ä¸ªåˆ†ç±»åˆå§‹åŒ–é»˜è®¤é¡ºåº
                for (const category in searchEnginesDB) {
                    if (searchEnginesDB[category].length > 0) {
                        this.settings.siteOrder[category] = searchEnginesDB[category].map(site => site.id);
                    }
                }
                // åˆå§‹åŒ–'all'åˆ†ç±»çš„é¡ºåºï¼ˆæ‰€æœ‰ç½‘ç«™çš„é¡ºåºï¼‰
                this.settings.siteOrder.all = [];
                for (const category in searchEnginesDB) {
                    this.settings.siteOrder.all = this.settings.siteOrder.all.concat(
                        searchEnginesDB[category].map(site => site.id)
                    );
                }
            }
            
            disableAllSites() {
                this.settings.enabledSites = {};
            }
            
            toggleSite(siteId, enabled) {
                this.settings.enabledSites[siteId] = enabled;
            }
            
            isSiteEnabled(siteId) {
                return this.settings.enabledSites[siteId] === true;
            }
            
            getEnabledCount() {
                return Object.keys(this.settings.enabledSites).filter(id => this.settings.enabledSites[id]).length;
            }
            
            updateSiteOrder(category, siteIds) {
                this.settings.siteOrder[category] = siteIds;
            }
            
            getSiteOrder(category) {
                return this.settings.siteOrder[category] || [];
            }
            
            addCustomSite(site) {
                const siteId = 'custom_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const newSite = {
                    ...site,
                    id: siteId,
                    custom: true
                };
                
                // å¦‚æœé€‰æ‹©äº†è‡ªå®šä¹‰åˆ†ç±»ä¸”æœ‰è¾“å…¥åˆ†ç±»åç§°
                let targetCategory = site.category;
                if (site.category === 'custom' && site.customCategoryName) {
                    targetCategory = site.customCategoryName;
                    // æ·»åŠ åˆ°è‡ªå®šä¹‰åˆ†ç±»åˆ—è¡¨
                    if (!this.settings.customCategories.includes(targetCategory)) {
                        this.settings.customCategories.push(targetCategory);
                    }
                    // ç¡®ä¿æœ‰è¿™ä¸ªåˆ†ç±»çš„æ’åºæ•°ç»„
                    if (!this.settings.siteOrder[targetCategory]) {
                        this.settings.siteOrder[targetCategory] = [];
                    }
                    // ç¡®ä¿æ•°æ®åº“æœ‰è¿™ä¸ªåˆ†ç±»
                    if (!searchEnginesDB[targetCategory]) {
                        searchEnginesDB[targetCategory] = [];
                    }
                    searchEnginesDB[targetCategory].push(newSite);
                } else {
                    searchEnginesDB.custom.push(newSite);
                    targetCategory = 'custom';
                }
                
                // æ·»åŠ åˆ°æ’åºé¡ºåº
                if (!this.settings.siteOrder[targetCategory]) {
                    this.settings.siteOrder[targetCategory] = [];
                }
                this.settings.siteOrder[targetCategory].push(siteId);
                
                // é»˜è®¤å¯ç”¨
                this.toggleSite(siteId, true);
                
                return { siteId, category: targetCategory };
            }
            
            removeCustomSite(siteId) {
                // åœ¨æ‰€æœ‰åˆ†ç±»ä¸­æŸ¥æ‰¾å¹¶åˆ é™¤
                for (const category in searchEnginesDB) {
                    const index = searchEnginesDB[category].findIndex(site => site.id === siteId);
                    if (index !== -1) {
                        searchEnginesDB[category].splice(index, 1);
                        
                        // ä»æ’åºé¡ºåºä¸­ç§»é™¤
                        if (this.settings.siteOrder[category]) {
                            const orderIndex = this.settings.siteOrder[category].indexOf(siteId);
                            if (orderIndex !== -1) {
                                this.settings.siteOrder[category].splice(orderIndex, 1);
                            }
                        }
                        
                        // ä»å¯ç”¨åˆ—è¡¨ä¸­ç§»é™¤
                        delete this.settings.enabledSites[siteId];
                        
                        return { success: true, category };
                    }
                }
                return { success: false };
            }
            
            setFeature(feature, value) {
                this.settings.features[feature] = value;
            }
            
            getFeature(feature) {
                return this.settings.features[feature] || false;
            }
            
            exportSettings() {
                const data = {
                    settings: this.settings,
                    version: '1.4',
                    exportDate: new Date().toISOString()
                };
                return JSON.stringify(data, null, 2);
            }
            
            importSettings(jsonData) {
                try {
                    const data = JSON.parse(jsonData);
                    if (data.settings) {
                        this.settings = {
                            ...this.settings,
                            ...data.settings,
                            features: {
                                ...this.settings.features,
                                ...(data.settings.features || {})
                            },
                            siteOrder: {
                                ...this.settings.siteOrder,
                                ...(data.settings.siteOrder || {})
                            }
                        };
                        
                        // ç¡®ä¿è‡ªå®šä¹‰ç½‘ç«™è¢«åŠ è½½åˆ°æ•°æ®åº“ä¸­
                        if (this.settings.customSites && this.settings.customSites.length > 0) {
                            searchEnginesDB.custom = this.settings.customSites;
                        }
                        
                        this.saveSettings();
                        return true;
                    }
                } catch (error) {
                    console.error('å¯¼å…¥è®¾ç½®å¤±è´¥:', error);
                }
                return false;
            }
            
            resetOrder() {
                this.initializeDefaultOrder();
                this.saveSettings();
            }
            
            // è·å–å½“å‰åˆ†ç±»çš„æ’åºç½‘ç«™
            getSortedSitesForCategory(category) {
                const orderedSiteIds = this.getSiteOrder(category) || [];
                
                // è·å–å½“å‰åˆ†ç±»çš„æ‰€æœ‰ç½‘ç«™
                let allSites = [];
                if (category === 'all') {
                    // 'all'åˆ†ç±»åŒ…å«æ‰€æœ‰ç½‘ç«™çš„æ··åˆ
                    for (const cat in searchEnginesDB) {
                        allSites = allSites.concat(searchEnginesDB[cat] || []);
                    }
                } else {
                    allSites = searchEnginesDB[category] || [];
                }
                
                // æŒ‰ä¿å­˜çš„é¡ºåºæ’åº
                const sortedSites = [];
                const siteMap = new Map(allSites.map(site => [site.id, site]));
                
                // é¦–å…ˆæ·»åŠ æœ‰åºçš„ç½‘ç«™
                orderedSiteIds.forEach(siteId => {
                    const site = siteMap.get(siteId);
                    if (site && this.isSiteEnabled(site.id)) {
                        sortedSites.push(site);
                        siteMap.delete(siteId);
                    }
                });
                
                // ç„¶åæ·»åŠ å‰©ä½™çš„ç½‘ç«™ï¼ˆæ–°æ·»åŠ æˆ–æœªæ’åºçš„ï¼‰
                siteMap.forEach(site => {
                    if (this.isSiteEnabled(site.id)) {
                        sortedSites.push(site);
                    }
                });
                
                return sortedSites;
            }
            
            // æ·»åŠ è‡ªå®šä¹‰åˆ†ç±»
            addCustomCategory(categoryName) {
                if (!this.settings.customCategories.includes(categoryName)) {
                    this.settings.customCategories.push(categoryName);
                    if (!this.settings.siteOrder[categoryName]) {
                        this.settings.siteOrder[categoryName] = [];
                    }
                    if (!searchEnginesDB[categoryName]) {
                        searchEnginesDB[categoryName] = [];
                    }
                    return true;
                }
                return false;
            }
        }

        // è‡ªå®šä¹‰æç¤ºæ¡†ç®¡ç†
        class AlertManager {
            constructor() {
                this.alert = document.getElementById('customAlert');
                this.alertTitle = document.getElementById('alertTitle');
                this.alertMessage = document.getElementById('alertMessage');
                this.alertIcon = document.getElementById('alertIcon');
                this.alertCancel = document.getElementById('alertCancel');
                this.alertConfirm = document.getElementById('alertConfirm');
                
                this.init();
            }
            
            init() {
                this.alertCancel.addEventListener('click', () => this.hide());
                this.alert.addEventListener('click', (e) => {
                    if (e.target === this.alert) {
                        this.hide();
                    }
                });
            }
            
            show(options) {
                const {
                    title = 'æç¤º',
                    message = '',
                    type = 'info', // info, success, warning, error
                    showCancel = true,
                    cancelText = 'å–æ¶ˆ',
                    confirmText = 'ç¡®å®š',
                    onConfirm = () => {},
                    onCancel = () => {}
                } = options;
                
                this.alertTitle.textContent = title;
                this.alertMessage.textContent = message;
                
                // è®¾ç½®å›¾æ ‡
                this.alertIcon.className = 'alert-icon';
                switch(type) {
                    case 'success':
                        this.alertIcon.classList.add('success');
                        this.alertIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
                        break;
                    case 'warning':
                        this.alertIcon.classList.add('warning');
                        this.alertIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
                        break;
                    case 'error':
                        this.alertIcon.classList.add('error');
                        this.alertIcon.innerHTML = '<i class="fas fa-times-circle"></i>';
                        break;
                    default:
                        this.alertIcon.classList.add('success');
                        this.alertIcon.innerHTML = '<i class="fas fa-info-circle"></i>';
                }
                
                // è®¾ç½®æŒ‰é’®
                this.alertCancel.textContent = cancelText;
                this.alertCancel.style.display = showCancel ? 'inline-block' : 'none';
                this.alertConfirm.textContent = confirmText;
                
                // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨
                const newConfirm = this.alertConfirm.cloneNode(true);
                this.alertConfirm.parentNode.replaceChild(newConfirm, this.alertConfirm);
                this.alertConfirm = newConfirm;
                
                const newCancel = this.alertCancel.cloneNode(true);
                this.alertCancel.parentNode.replaceChild(newCancel, this.alertCancel);
                this.alertCancel = newCancel;
                
                // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
                this.alertConfirm.addEventListener('click', () => {
                    onConfirm();
                    this.hide();
                });
                
                this.alertCancel.addEventListener('click', () => {
                    onCancel();
                    this.hide();
                });
                
                // æ˜¾ç¤ºæç¤ºæ¡†
                this.alert.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            hide() {
                this.alert.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            confirm(options) {
                return new Promise((resolve) => {
                    this.show({
                        ...options,
                        onConfirm: () => resolve(true),
                        onCancel: () => resolve(false)
                    });
                });
            }
            
            alert(options) {
                return new Promise((resolve) => {
                    this.show({
                        ...options,
                        showCancel: false,
                        onConfirm: () => resolve()
                    });
                });
            }
        }

        // åº”ç”¨ä¸»ç±»
        class SearchStartPage {
            constructor() {
                this.settingsManager = new SettingsManager();
                this.alertManager = new AlertManager();
                this.currentCategory = 'all';
                this.sortableInstance = null;
                this.init();
            }
            
            init() {
                this.bindEvents();
                this.renderCategoryTabs();
                this.renderCategoryFilters();
                this.renderSearchGrid();
                this.updateCustomSitesSection();
                this.loadFeatureSwitches();
                this.bindCustomCategoryInput();
            }
            
            bindEvents() {
                // è®¾ç½®é¢æ¿
                document.getElementById('openSettings').addEventListener('click', () => this.openSettings());
                document.getElementById('closeSettings').addEventListener('click', () => this.closeSettings());
                document.getElementById('overlay').addEventListener('click', () => this.closeSettings());
                
                // åŠŸèƒ½å¼€å…³
                document.getElementById('enableSort').addEventListener('change', (e) => {
                    this.settingsManager.setFeature('enableSort', e.target.checked);
                    this.renderSearchGrid();
                    this.updateSortingHint();
                    this.settingsManager.saveSettings();
                });
                
                document.getElementById('enableHide').addEventListener('change', (e) => {
                    this.settingsManager.setFeature('enableHide', e.target.checked);
                    this.renderSearchGrid();
                    this.settingsManager.saveSettings();
                });
                
                // è®¾ç½®æ“ä½œ
                document.getElementById('selectAll').addEventListener('click', () => this.selectAllSites());
                document.getElementById('deselectAll').addEventListener('click', () => this.deselectAllSites());
                document.getElementById('resetOrder').addEventListener('click', () => this.resetOrder());
                document.getElementById('saveSettings').addEventListener('click', () => this.saveAndCloseSettings());
                
                // æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™
                document.getElementById('addCustomSite').addEventListener('click', () => this.addCustomSite());
                
                // å¯¼å…¥å¯¼å‡º
                document.getElementById('exportSettings').addEventListener('click', () => this.exportSettings());
                document.getElementById('importSettings').addEventListener('click', () => this.triggerImport());
                document.getElementById('importFile').addEventListener('change', (e) => this.importSettings(e));
                
                // å›è½¦é”®æœç´¢
                document.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && e.target.classList.contains('search-input')) {
                        e.preventDefault();
                        const siteId = e.target.dataset.siteId;
                        this.search(siteId, e.target.value);
                    }
                });
                
                // ç‚¹å‡»å›¾æ ‡æˆ–ç½‘ç«™åç§°æ‰“å¼€ä¸»é¡µ
                document.addEventListener('click', (e) => {
                    const icon = e.target.closest('.icon-container');
                    const siteName = e.target.closest('.search-info h3');
                    
                    if (icon) {
                        const siteCard = icon.closest('.search-card');
                        const siteId = siteCard.dataset.siteId;
                        this.openHomepage(siteId);
                        e.preventDefault();
                    }
                    
                    if (siteName) {
                        const siteCard = siteName.closest('.search-card');
                        const siteId = siteCard.dataset.siteId;
                        this.openHomepage(siteId);
                        e.preventDefault();
                    }
                });
            }
            
            bindCustomCategoryInput() {
                const categorySelect = document.getElementById('customSiteCategory');
                const customCategoryInput = document.getElementById('customCategoryInput');
                
                categorySelect.addEventListener('change', () => {
                    if (categorySelect.value === 'custom') {
                        customCategoryInput.style.display = 'block';
                        customCategoryInput.required = true;
                    } else {
                        customCategoryInput.style.display = 'none';
                        customCategoryInput.required = false;
                    }
                });
            }
            
            loadFeatureSwitches() {
                const enableSort = this.settingsManager.getFeature('enableSort');
                const enableHide = this.settingsManager.getFeature('enableHide');
                
                document.getElementById('enableSort').checked = enableSort;
                document.getElementById('enableHide').checked = enableHide;
                
                this.updateSortingHint();
            }
            
            updateSortingHint() {
                const enableSort = this.settingsManager.getFeature('enableSort');
                const sortingHint = document.getElementById('sortingHint');
                
                if (enableSort) {
                    sortingHint.classList.remove('disabled');
                } else {
                    sortingHint.classList.add('disabled');
                }
            }
            
            renderCategoryTabs() {
                const container = document.getElementById('categoryTabs');
                
                // è·å–æ‰€æœ‰åˆ†ç±»
                const categories = {};
                
                // æ·»åŠ "å…¨éƒ¨"åˆ†ç±»
                categories['all'] = { name: 'å…¨éƒ¨ç½‘ç«™', icon: 'fas fa-globe' };
                
                // æ·»åŠ é¢„å®šä¹‰åˆ†ç±»
                const categoryNames = {
                    video: 'è§†é¢‘',
                    programming: 'ç¼–ç¨‹',
                    knowledge: 'çŸ¥è¯†',
                    search: 'æœç´¢',
                    shopping: 'è´­ç‰©',
                    social: 'ç¤¾äº¤',
                    music: 'éŸ³ä¹',
                    learning: 'å­¦ä¹ ',
                    tools: 'å·¥å…·',
                    news: 'æ–°é—»',
                    reading: 'é˜…è¯»',
                    finance: 'é‡‘è',
                    health: 'å¥åº·'
                };
                
                // æ·»åŠ æœ‰ç½‘ç«™çš„åˆ†ç±»
                for (const key in categoryNames) {
                    if (searchEnginesDB[key] && searchEnginesDB[key].length > 0) {
                        categories[key] = {
                            name: categoryNames[key],
                            icon: this.getCategoryIcon(key)
                        };
                    }
                }
                
                // æ·»åŠ è‡ªå®šä¹‰åˆ†ç±»
                if (this.settingsManager.settings.customCategories) {
                    this.settingsManager.settings.customCategories.forEach(cat => {
                        if (searchEnginesDB[cat] && searchEnginesDB[cat].length > 0) {
                            categories[cat] = {
                                name: cat,
                                icon: 'fas fa-user-cog'
                            };
                        }
                    });
                }
                
                // æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™åˆ†ç±»ï¼ˆå¦‚æœæœ‰è‡ªå®šä¹‰ç½‘ç«™ï¼‰
                if (searchEnginesDB.custom && searchEnginesDB.custom.length > 0) {
                    categories['custom'] = {
                        name: 'è‡ªå®šä¹‰',
                        icon: 'fas fa-user-cog'
                    };
                }
                
                container.innerHTML = Object.entries(categories).map(([id, category]) => `
                    <button class="category-tab ${id === this.currentCategory ? 'active' : ''}" 
                            data-category="${id}"
                            onclick="app.switchCategory('${id}')">
                        <i class="${category.icon}"></i> ${category.name}
                    </button>
                `).join('');
            }
            
            renderCategoryFilters() {
                const container = document.getElementById('categoryFilters');
                
                // è·å–æ‰€æœ‰åˆ†ç±»
                const categories = {};
                categories['all'] = { name: 'å…¨éƒ¨', icon: 'fas fa-globe' };
                
                // æ·»åŠ é¢„å®šä¹‰åˆ†ç±»
                const categoryNames = {
                    video: 'è§†é¢‘',
                    programming: 'ç¼–ç¨‹',
                    knowledge: 'çŸ¥è¯†',
                    search: 'æœç´¢',
                    shopping: 'è´­ç‰©',
                    social: 'ç¤¾äº¤',
                    music: 'éŸ³ä¹',
                    learning: 'å­¦ä¹ ',
                    tools: 'å·¥å…·',
                    news: 'æ–°é—»',
                    reading: 'é˜…è¯»',
                    finance: 'é‡‘è',
                    health: 'å¥åº·'
                };
                
                for (const key in categoryNames) {
                    if (searchEnginesDB[key] && searchEnginesDB[key].length > 0) {
                        categories[key] = {
                            name: categoryNames[key],
                            icon: this.getCategoryIcon(key)
                        };
                    }
                }
                
                // æ·»åŠ è‡ªå®šä¹‰åˆ†ç±»
                if (this.settingsManager.settings.customCategories) {
                    this.settingsManager.settings.customCategories.forEach(cat => {
                        if (searchEnginesDB[cat] && searchEnginesDB[cat].length > 0) {
                            categories[cat] = {
                                name: cat,
                                icon: 'fas fa-user-cog'
                            };
                        }
                    });
                }
                
                // æ·»åŠ è‡ªå®šä¹‰ç½‘ç«™åˆ†ç±»
                if (searchEnginesDB.custom && searchEnginesDB.custom.length > 0) {
                    categories['custom'] = {
                        name: 'è‡ªå®šä¹‰',
                        icon: 'fas fa-user-cog'
                    };
                }
                
                container.innerHTML = Object.entries(categories).map(([id, category]) => `
                    <button class="category-filter ${id === 'all' ? 'active' : ''}" 
                            data-category="${id}"
                            onclick="app.filterSitesByCategory('${id}')">
                        <i class="${category.icon}"></i> ${category.name}
                    </button>
                `).join('');
            }
            
            renderSearchGrid() {
                const container = document.getElementById('searchGrid');
                const enabledSites = this.settingsManager.getSortedSitesForCategory(this.currentCategory);
                
                if (enabledSites.length === 0) {
                    document.getElementById('emptyState').style.display = 'block';
                    document.getElementById('sortingHint').classList.add('disabled');
                    container.innerHTML = '';
                    return;
                }
                
                document.getElementById('emptyState').style.display = 'none';
                
                container.innerHTML = enabledSites.map(site => `
                    <div class="search-card" data-site-id="${site.id}">
                        ${this.renderCardControls(site)}
                        <div class="search-header">
                            <div class="icon-container" style="background: ${site.color}" title="ç‚¹å‡»è®¿é—®${site.name}ä¸»é¡µ">
                                <i class="${site.icon}"></i>
                            </div>
                            <div class="search-info">
                                <h3 title="ç‚¹å‡»è®¿é—®${site.name}ä¸»é¡µ">${site.name} ${site.custom ? '<span style="font-size:0.7em;color:#94a3b8;">(è‡ªå®šä¹‰)</span>' : ''}</h3>
                                <p>${site.description}</p>
                            </div>
                        </div>
                        <div class="input-group">
                            <input type="text" 
                                   class="search-input" 
                                   data-site-id="${site.id}"
                                   placeholder="åœ¨ ${site.name} æœç´¢..." 
                                   onkeypress="if(event.key === 'Enter') app.search('${site.id}', this.value)">
                            <button onclick="app.search('${site.id}', this.previousElementSibling.value)">
                                æœç´¢
                            </button>
                        </div>
                    </div>
                `).join('');
                
                // æ ¹æ®åŠŸèƒ½å¼€å…³çŠ¶æ€åˆå§‹åŒ–æ’åº
                this.initSortableIfEnabled();
            }
            
            renderCardControls(site) {
                const enableHide = this.settingsManager.getFeature('enableHide');
                const enableSort = this.settingsManager.getFeature('enableSort');
                let controls = '<div class="card-controls">';
                
                // éšè—æŒ‰é’®åœ¨å·¦è¾¹
                if (enableHide) {
                    controls += `
                        <button class="card-control-btn hide-btn" onclick="app.toggleSiteVisibility('${site.id}')" title="éšè—æ­¤ç½‘ç«™">
                            <i class="fas fa-eye-slash"></i>
                        </button>
                    `;
                }
                
                // æ’åºæ‰‹æŸ„åœ¨å³è¾¹
                if (enableSort) {
                    controls += `
                        <button class="card-control-btn sort-handle" title="æ‹–æ‹½æ’åº">
                            <i class="fas fa-arrows-alt"></i>
                        </button>
                    `;
                }
                
                // è‡ªå®šä¹‰ç½‘ç«™çš„åˆ é™¤æŒ‰é’®
                if (site.custom) {
                    controls += `
                        <button class="card-control-btn" onclick="app.deleteCustomSite('${site.id}')" title="åˆ é™¤æ­¤ç½‘ç«™" style="color: #ef4444;">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                }
                
                controls += '</div>';
                return controls;
            }
            
            renderSitesGrid(category = 'all') {
                const container = document.getElementById('sitesGrid');
                const sites = this.getSitesByCategory(category);
                
                container.innerHTML = sites.map(site => `
                    <label class="site-checkbox">
                        <input type="checkbox" 
                               ${this.settingsManager.isSiteEnabled(site.id) ? 'checked' : ''}
                               onchange="app.toggleSiteSetting('${site.id}', this.checked)">
                        <div class="site-info">
                            <div class="small-icon" style="background: ${site.color}">
                                <i class="${site.icon}"></i>
                            </div>
                            <span>${site.name} ${site.custom ? '(è‡ªå®šä¹‰)' : ''}</span>
                        </div>
                    </label>
                `).join('');
            }
            
            renderCustomSitesGrid() {
                const container = document.getElementById('customSitesGrid');
                let customSites = [];
                
                // æ”¶é›†æ‰€æœ‰è‡ªå®šä¹‰ç½‘ç«™ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰åˆ†ç±»ä¸­çš„ï¼‰
                for (const category in searchEnginesDB) {
                    // è·³è¿‡é¢„å®šä¹‰åˆ†ç±»
                    const predefined = ['video', 'programming', 'knowledge', 'search', 'shopping', 
                                      'social', 'music', 'learning', 'tools', 'news', 'reading', 
                                      'finance', 'health'];
                    
                    if (!predefined.includes(category) && category !== 'custom') {
                        // æ£€æŸ¥æ˜¯å¦æ˜¯è‡ªå®šä¹‰åˆ†ç±»
                        const sitesInCategory = searchEnginesDB[category] || [];
                        const customSitesInCategory = sitesInCategory.filter(site => site.custom);
                        customSites = customSites.concat(customSitesInCategory);
                    }
                }
                
                // æ·»åŠ é»˜è®¤customåˆ†ç±»ä¸­çš„ç½‘ç«™
                customSites = customSites.concat(searchEnginesDB.custom || []);
                
                if (customSites.length === 0) {
                    document.getElementById('customSitesSection').style.display = 'none';
                    return;
                }
                
                document.getElementById('customSitesSection').style.display = 'block';
                container.innerHTML = customSites.map(site => `
                    <div class="site-checkbox" style="justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" 
                                   ${this.settingsManager.isSiteEnabled(site.id) ? 'checked' : ''}
                                   onchange="app.toggleSiteSetting('${site.id}', this.checked)">
                            <div class="site-info">
                                <div class="small-icon" style="background: ${site.color}">
                                    <i class="${site.icon}"></i>
                                </div>
                                <div>
                                    <div style="font-weight: 600;">${site.name}</div>
                                    <div style="font-size: 0.8rem; color: #64748b;">${site.description}</div>
                                </div>
                            </div>
                        </div>
                        <button class="card-control-btn" onclick="app.deleteCustomSite('${site.id}')" title="åˆ é™¤æ­¤ç½‘ç«™" style="color: #ef4444;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `).join('');
            }
            
            getCategoryIcon(category) {
                const icons = {
                    video: 'fas fa-video',
                    programming: 'fas fa-code',
                    knowledge: 'fas fa-book',
                    search: 'fas fa-search',
                    shopping: 'fas fa-shopping-cart',
                    social: 'fas fa-users',
                    music: 'fas fa-music',
                    learning: 'fas fa-graduation-cap',
                    tools: 'fas fa-tools',
                    news: 'fas fa-newspaper',
                    reading: 'fas fa-book-open',
                    finance: 'fas fa-chart-line',
                    health: 'fas fa-heartbeat',
                    custom: 'fas fa-user-cog',
                    all: 'fas fa-globe'
                };
                return icons[category] || 'fas fa-globe';
            }
            
            getSitesByCategory(category) {
                if (category === 'all') {
                    // è·å–æ‰€æœ‰ç½‘ç«™
                    let allSites = [];
                    for (const cat in searchEnginesDB) {
                        allSites = allSites.concat(searchEnginesDB[cat] || []);
                    }
                    return allSites;
                }
                return searchEnginesDB[category] || [];
            }
            
            initSortableIfEnabled() {
                const enableSort = this.settingsManager.getFeature('enableSort');
                
                if (!enableSort) {
                    if (this.sortableInstance) {
                        this.sortableInstance.destroy();
                        this.sortableInstance = null;
                    }
                    return;
                }
                
                if (this.sortableInstance) {
                    this.sortableInstance.destroy();
                }
                
                const container = document.getElementById('searchGrid');
                if (!container) return;
                
                this.sortableInstance = new Sortable(container, {
                    animation: 150,
                    ghostClass: 'sortable-ghost',
                    chosenClass: 'sortable-chosen',
                    handle: '.sort-handle',
                    onEnd: (evt) => {
                        this.saveCurrentOrder();
                    }
                });
            }
            
            saveCurrentOrder() {
                const container = document.getElementById('searchGrid');
                const siteIds = Array.from(container.children)
                    .map(card => card.getAttribute('data-site-id'))
                    .filter(id => id);
                
                // ä¿å­˜å½“å‰åˆ†ç±»çš„æ’åºé¡ºåº
                this.settingsManager.updateSiteOrder(this.currentCategory, siteIds);
                this.settingsManager.saveSettings();
            }
            
            switchCategory(category) {
                this.currentCategory = category;
                this.renderCategoryTabs();
                this.renderSearchGrid();
            }
            
            filterSitesByCategory(category) {
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.category-filter').forEach(btn => {
                    btn.classList.remove('active');
                });
                event.target.classList.add('active');
                
                this.renderSitesGrid(category);
                this.updateCustomSitesSection();
            }
            
            search(siteId, keyword) {
                if (!keyword || !keyword.trim()) {
                    this.alertManager.alert({
                        title: 'æç¤º',
                        message: 'è¯·è¾“å…¥æœç´¢å…³é”®è¯ï¼',
                        type: 'warning'
                    });
                    return;
                }
                
                // æŸ¥æ‰¾ç½‘ç«™é…ç½®
                let targetSite = null;
                for (const category in searchEnginesDB) {
                    const site = searchEnginesDB[category].find(s => s.id === siteId);
                    if (site) {
                        targetSite = site;
                        break;
                    }
                }
                
                if (targetSite) {
                    const encodedKeyword = encodeURIComponent(keyword.trim());
                    const url = targetSite.url.replace('{keyword}', encodedKeyword);
                    window.open(url, '_blank');
                }
            }
            
            openHomepage(siteId) {
                // æŸ¥æ‰¾ç½‘ç«™é…ç½®
                let targetSite = null;
                for (const category in searchEnginesDB) {
                    const site = searchEnginesDB[category].find(s => s.id === siteId);
                    if (site) {
                        targetSite = site;
                        break;
                    }
                }
                
                if (targetSite && targetSite.homepage) {
                    window.open(targetSite.homepage, '_blank');
                } else if (targetSite) {
                    // å¦‚æœæ²¡æœ‰ä¸»é¡µï¼Œå°è¯•ä»æœç´¢URLä¸­æå–
                    try {
                        const urlObj = new URL(targetSite.url.replace('{keyword}', ''));
                        window.open(urlObj.origin, '_blank');
                    } catch (e) {
                        this.alertManager.alert({
                            title: 'é”™è¯¯',
                            message: 'æ— æ³•æ‰“å¼€ç½‘ç«™ä¸»é¡µ',
                            type: 'error'
                        });
                    }
                }
            }
            
            openSettings() {
                document.getElementById('settingsPanel').classList.add('active');
                document.getElementById('overlay').classList.add('active');
                this.renderSitesGrid('all');
                this.updateCustomSitesSection();
                this.loadFeatureSwitches();
            }
            
            closeSettings() {
                document.getElementById('settingsPanel').classList.remove('active');
                document.getElementById('overlay').classList.remove('active');
            }
            
            toggleSiteSetting(siteId, enabled) {
                this.settingsManager.toggleSite(siteId, enabled);
            }
            
            toggleSiteVisibility(siteId) {
                this.settingsManager.toggleSite(siteId, false);
                this.renderSearchGrid();
                this.settingsManager.saveSettings();
                
                this.alertManager.alert({
                    title: 'å·²éšè—',
                    message: 'ç½‘ç«™å·²éšè—ï¼Œå¯åœ¨è®¾ç½®ä¸­é‡æ–°å¯ç”¨',
                    type: 'success'
                });
            }
            
            selectAllSites() {
                const category = document.querySelector('.category-filter.active').dataset.category;
                const sites = this.getSitesByCategory(category);
                sites.forEach(site => {
                    this.settingsManager.toggleSite(site.id, true);
                });
                this.renderSitesGrid(category);
                this.updateCustomSitesSection();
            }
            
            deselectAllSites() {
                const category = document.querySelector('.category-filter.active').dataset.category;
                const sites = this.getSitesByCategory(category);
                sites.forEach(site => {
                    this.settingsManager.toggleSite(site.id, false);
                });
                this.renderSitesGrid(category);
                this.updateCustomSitesSection();
            }
            
            async resetOrder() {
                const confirmed = await this.alertManager.confirm({
                    title: 'ç¡®è®¤é‡ç½®',
                    message: 'ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ’åºé¡ºåºå—ï¼Ÿè¿™å°†æ¢å¤ä¸ºé»˜è®¤é¡ºåºã€‚',
                    type: 'warning'
                });
                
                if (confirmed) {
                    this.settingsManager.resetOrder();
                    this.renderSearchGrid();
                    this.alertManager.alert({
                        title: 'å·²é‡ç½®',
                        message: 'æ’åºé¡ºåºå·²é‡ç½®ï¼',
                        type: 'success'
                    });
                }
            }
            
            saveAndCloseSettings() {
                this.settingsManager.saveSettings();
                this.renderSearchGrid();
                this.updateSortingHint();
                this.closeSettings();
                
                this.alertManager.alert({
                    title: 'å·²ä¿å­˜',
                    message: 'è®¾ç½®å·²ä¿å­˜æˆåŠŸï¼',
                    type: 'success'
                });
            }
            
            updateCustomSitesSection() {
                this.renderCustomSitesGrid();
            }
            
            async addCustomSite() {
                const name = document.getElementById('customSiteName').value.trim();
                const url = document.getElementById('customSiteUrl').value.trim();
                const homepage = document.getElementById('customSiteHomepage').value.trim();
                const icon = document.getElementById('customSiteIcon').value;
                const color = document.getElementById('customSiteColor').value;
                const category = document.getElementById('customSiteCategory').value;
                const customCategoryName = document.getElementById('customCategoryInput').value.trim();
                const description = document.getElementById('customSiteDesc').value.trim();
                
                if (!name || !url) {
                    this.alertManager.alert({
                        title: 'è¾“å…¥é”™è¯¯',
                        message: 'è¯·å¡«å†™ç½‘ç«™åç§°å’Œæœç´¢URLæ ¼å¼ï¼',
                        type: 'warning'
                    });
                    return;
                }
                
                if (!url.includes('{keyword}')) {
                    this.alertManager.alert({
                        title: 'URLæ ¼å¼é”™è¯¯',
                        message: 'æœç´¢URLæ ¼å¼å¿…é¡»åŒ…å« {keyword} ä½œä¸ºå…³é”®è¯å ä½ç¬¦ï¼',
                        type: 'warning'
                    });
                    return;
                }
                
                // å¦‚æœæ˜¯è‡ªå®šä¹‰åˆ†ç±»ï¼Œéœ€è¦åˆ†ç±»åç§°
                if (category === 'custom' && !customCategoryName) {
                    this.alertManager.alert({
                        title: 'è¾“å…¥é”™è¯¯',
                        message: 'è¯·å¡«å†™è‡ªå®šä¹‰åˆ†ç±»åç§°ï¼',
                        type: 'warning'
                    });
                    return;
                }
                
                const newSite = {
                    name,
                    url,
                    homepage: homepage || '',
                    icon,
                    color,
                    description: description || `æœç´¢${name}ç›¸å…³å†…å®¹...`,
                    category,
                    customCategoryName: category === 'custom' ? customCategoryName : ''
                };
                
                const { siteId, category: targetCategory } = this.settingsManager.addCustomSite(newSite);
                this.settingsManager.saveSettings();
                
                // æ¸…ç©ºè¡¨å•
                document.getElementById('customSiteName').value = '';
                document.getElementById('customSiteUrl').value = '';
                document.getElementById('customSiteHomepage').value = '';
                document.getElementById('customSiteDesc').value = '';
                document.getElementById('customCategoryInput').value = '';
                document.getElementById('customCategoryInput').style.display = 'none';
                
                // æ›´æ–°æ˜¾ç¤º
                this.renderCategoryTabs();
                this.renderSearchGrid();
                this.updateCustomSitesSection();
                this.renderSitesGrid('all');
                
                this.alertManager.alert({
                    title: 'æ·»åŠ æˆåŠŸ',
                    message: `è‡ªå®šä¹‰ç½‘ç«™"${name}"æ·»åŠ æˆåŠŸï¼`,
                    type: 'success'
                });
            }
            
            async deleteCustomSite(siteId) {
                const confirmed = await this.alertManager.confirm({
                    title: 'ç¡®è®¤åˆ é™¤',
                    message: 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè‡ªå®šä¹‰ç½‘ç«™å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚',
                    type: 'warning'
                });
                
                if (confirmed) {
                    const { success, category } = this.settingsManager.removeCustomSite(siteId);
                    if (success) {
                        this.settingsManager.saveSettings();
                        this.renderCategoryTabs();
                        this.renderSearchGrid();
                        this.updateCustomSitesSection();
                        this.renderSitesGrid('all');
                        
                        this.alertManager.alert({
                            title: 'å·²åˆ é™¤',
                            message: 'è‡ªå®šä¹‰ç½‘ç«™å·²åˆ é™¤ï¼',
                            type: 'success'
                        });
                    }
                }
            }
            
            exportSettings() {
                const data = this.settingsManager.exportSettings();
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `æœç´¢èµ·å§‹é¡µè®¾ç½®_${new Date().toLocaleDateString()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.alertManager.alert({
                    title: 'å¯¼å‡ºæˆåŠŸ',
                    message: 'è®¾ç½®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶ï¼Œè¯·å¦¥å–„ä¿å­˜ï¼',
                    type: 'success'
                });
            }
            
            triggerImport() {
                document.getElementById('importFile').click();
            }
            
            importSettings(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = async (e) => {
                    const success = this.settingsManager.importSettings(e.target.result);
                    if (success) {
                        this.alertManager.alert({
                            title: 'å¯¼å…¥æˆåŠŸ',
                            message: 'è®¾ç½®å¯¼å…¥æˆåŠŸï¼',
                            type: 'success'
                        });
                        
                        this.renderCategoryTabs();
                        this.renderSearchGrid();
                        this.updateCustomSitesSection();
                        this.renderSitesGrid('all');
                        this.loadFeatureSwitches();
                    } else {
                        this.alertManager.alert({
                            title: 'å¯¼å…¥å¤±è´¥',
                            message: 'å¯¼å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼',
                            type: 'error'
                        });
                    }
                    event.target.value = '';
                };
                reader.readAsText(file);
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new SearchStartPage();
        
        // æš´éœ²å¿…è¦çš„æ–¹æ³•ç»™å…¨å±€ä½œç”¨åŸŸ
        window.app = app;
    </script>
</body>
</html>